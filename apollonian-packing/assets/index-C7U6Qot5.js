(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();function _(e,t,s,n,i,r){let a,o,c,h,u,d,f,w,b;if(o=n-e,c=i-t,h=Math.sqrt(c*c+o*o),h>s+r)throw new Error("No intersections");if(h<Math.abs(s-r))throw new Error("No intersections");a=(s*s-r*r+h*h)/(2*h),w=e+o*a/h,b=t+c*a/h,u=Math.sqrt(s*s-a*a),d=-c*(u/h),f=o*(u/h);let y=w+d,m=w-d,T=b+f,L=b-f;return[{x:y,y:T},{x:m,y:L}]}function P(e,t){const s=e.x-t.x,n=e.y-t.y;return Math.sqrt(s*s+n*n)}function R(e,t,s){const n=e+t+s,i=Math.sqrt(2*(e+t+s)**2-2*(e**2+t**2+s**2));return[n+i,n-i]}function A(e,t,s){return _(e.x,e.y,Math.abs(1/e.k+1/s),t.x,t.y,Math.abs(1/t.k+1/s)).map(n=>({...n,k:s}))}function g(e,t,s){return R(e.k,t.k,s.k).flatMap(n=>{try{const[i,r]=A(e,t,n),[a,o]=[s.k*P(i,s),s.k*P(r,s)],c=1/s.k+1/n;return[Math.abs(c-a)<Math.abs(c-o)?i:r]}catch{return[]}}).map(n=>({circle:n,parents:[e,t,s]}))}function $(e,t,s,n){const[i,r]=g(e,t,s),[a,o]=[i.circle.k,r.circle.k];return Math.abs(a-n.k)>Math.abs(o-n.k)?i:r}const q=17,N=.001;function B(e,t,s){const n={root:[],children:[]},i=1,r=i*e,a=r*t;n.root.push({x:-i,y:0,k:1/i}),n.root.push({x:r,y:0,k:1/r}),n.root.push(A(n.root[0],n.root[1],1/a)[0]);let o=g(n.root[0],n.root[1],n.root[2]);n.children.push(...o);for(let c=0;c<(s?.maxGenerations??q);c++){const h=o;o=[];for(let{circle:u,parents:d}of h)for(let f of d){const[w,b]=d.filter(m=>m!==f),y=$(u,w,b,f);isFinite(y.circle.k)&&(1/Math.abs(y.circle.k)<(s?.minRadius??N)||1/Math.abs(y.circle.k)>s?.maxRadius||(n.children.push(y),o.push(y)))}}return n}function K(e){const s=1/e,n=Math.max(...R(1,s,0));return B(1/s,s/n,{maxRadius:1})}function j(e,t,s,n){const i=document.getElementById(e);if(!(i instanceof HTMLCanvasElement))throw new Error(`Not a canvas: ${e}`);return{canvas:i,context:i.getContext("2d"),scale:t*i.width,xPos:s,yPos:n}}const X=(e,t)=>e.canvas.width/2+e.scale*(t-e.xPos),Y=(e,t)=>e.canvas.height/2+e.scale*(t-e.yPos);function F(e){e.context.clearRect(0,0,e.canvas.width,e.canvas.height),e.context.strokeStyle="black",e.context.lineWidth=3,e.context.beginPath(),e.context.rect(0,0,e.canvas.width,e.canvas.height),e.context.stroke()}function H(e,t,s,n){e.context.strokeStyle="black",e.context.lineWidth=1,e.context.beginPath(),e.context.arc(X(e,t),Y(e,1-s),n,0,2*Math.PI),e.context.fill()}function G(e){F(e),e.context.lineWidth=3,e.context.strokeStyle="black";for(let t=1;t>0;t-=.01)try{const s=K(t);for(let{parents:n}of s.children){const i=n.map(o=>o.k).sort((o,c)=>o-c),r=i[0]/i[1],a=i[1]/i[2];H(e,r,a,.25)}}catch{}}class p{a1;a2;a3;_iT=null;_in=null;_oT=null;_out=null;constructor(t,s,n){const i=[t,s,n].sort((r,a)=>x(r)-x(a));this.a1=i[0],this.a2=i[1],this.a3=i[2]}get iT(){return this._iT}get in(){return this._in}get oT(){return this._oT}get out(){return this._out}toString(){return`{${x(this.a1)}, ${x(this.a2)}, ${x(this.a3)}}`}setInWithTriples(t,s,n,i){return this._in===null&&(this._in=t,this._iT=[s,n,i]),this._iT}setIn(t){return this.setInWithTriples(t,new p(t,this.a2,this.a3),new p(t,this.a1,this.a3),new p(t,this.a1,this.a2))}setOutWithTriples(t,s,n,i){return this._out===null&&(this._out=t,this._oT=[s,n,i]),this._oT}setOut(t){return this.setOutWithTriples(t,new p(t,this.a2,this.a3),new p(t,this.a1,this.a3),new p(t,this.a1,this.a2))}draw(t,s=k(),n=null,i=!1){const r=t.strokeStyle,a=t.lineWidth;t.strokeStyle="blue",t.lineWidth=1;for(const o of[this.in,this.out])o!==null&&(n!==null?o!==n.a1&&o!==n.a2&&o!==n.a3&&S(t,o,s):S(t,o,s));for(const o of[this.iT,this.oT])if(o!==null){const[c,h,u]=o;n!==null?c!==n&&h!==n&&u!==n&&[c,h,u].forEach(d=>d.draw(t,s,this)):[c,h,u].forEach(d=>d.draw(t,s,this))}t.strokeStyle=r,t.lineWidth=a,i&&[this.a1,this.a2,this.a3].forEach(o=>S(t,o,s))}recurse(){if(this.in!==null&&this.out!==null)return;const t=Math.max(this.a1.k,this.a2.k,this.a3.k);if(this.a1.kind==="circle"&&this.a2.kind==="circle"&&this.a3.kind==="circle"){const s=this.a1,n=this.a2,i=this.a3;if(x(this.a1)<0&&this.in!==null!=(this.out!==null)){const r=[!0,!1].map(c=>I(s,n,i,c)),a=this.in!==null?this.in:this.out,o=tt(a,r[0],r[1]);this.recurseWith(o,t,this.out===null)}else for(const[r,a]of[[this.out,!0],[this.in,!1]])if(r===null){const o=I(s,n,i,a);o!==null&&this.recurseWith(o,t,a)}}}recurseWith(t,s,n){if(t.kind==="circle"&&t.k<s||x(t)<=l.maxCurvature&&it(t)<=l.maxDepth){const i=new p(t,this.a2,this.a3),r=new p(t,this.a1,this.a3),a=new p(t,this.a1,this.a2);n?(this.setOutWithTriples(t,i,r,a),i.setOutWithTriples(this.a1,this,r,a),r.setOutWithTriples(this.a2,this,i,a),a.setInWithTriples(this.a3,this,i,r)):(this.setInWithTriples(t,i,r,a),i.setOutWithTriples(this.a1,this,r,a),r.setOutWithTriples(this.a2,this,i,a),a.setOutWithTriples(this.a3,this,i,r)),[i,r,a].forEach(o=>o.recurse())}}}const l=(()=>{const n=[500,140];let i=.5,r=.4,a=1200,o=800,c;return console.log("Initializing!!"),{get maxCurvature(){return 10},get maxDepth(){return 10},get triple(){return c},set triple(h){c=h},get r1(){return i},get r2(){return r},getW(){return a},getH(){return o},setDimensions(h,u){a=h,o=u},adjustR1(h){i=E(i+h,.01,1),console.log(`r1 -> ${i.toFixed(4)}`)},adjustR2(h){r=E(r+h,.01,1),console.log(`r2 -> ${r.toFixed(4)}`)},rebuildTriple(){c=U(i,r,100,n)}}})();function E(e,t,s){return Math.max(t,Math.min(s,e))}function U(e,t,s,n){const i=C(1/s,n[0],n[1],1),r=C(1/(s*e),n[0]+s+s*e,n[1],1),a=D(i,r,1/(s*e*t))[1],o=new p(i,r,a);return o.recurse(),o}function J(e,t,s){return e+t+s+2*Math.sqrt(e*t+e*s+t*s)}function Q(e,t,s){return e+t+s-2*Math.sqrt(e*t+e*s+t*s)}function Z(e,t,s,n){return n?Q(e,t,s):J(e,t,s)}function D(e,t,s){const n=1/Math.abs(s),i=s>0?n+e.r:n-e.r,r=s>0?n+t.r:n-t.r,a=t.x-e.x,o=t.y-e.y,c=Math.sqrt(a*a+o*o),h=(i*i-r*r+c*c)/(2*c),u=Math.sqrt(i*i-h*h),d=e.x+h/c*a,f=e.y+h/c*o,w=d+u/c*o,b=f-u/c*a,y=d-u/c*o,m=f+u/c*a,T=z(e)||z(e)?1:Math.max(O(e),O(t))+1;return[C(s,w,b,T),C(s,y,m,T)]}function W(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function V(e,t,s){return W(e,t)<W(e,s)?s:t}function tt(e,t,s){return e.kind==="circle"&&t.kind==="circle"&&s.kind==="circle"?V(e,t,s):e.kind==="line"&&t.kind==="line"&&s.kind==="line"?Math.abs(e.b-t.b)<Math.abs(e.b-s.b)?s:t:e.kind==="line"&&t.kind==="line"&&s.kind==="circle"||e.kind==="circle"&&t.kind==="circle"&&s.kind==="line"?t:s}function I(e,t,s,n){const i=Z(e.k,t.k,s.k,n),r=1/Math.abs(i),a=D(t,s,i);function o(c){return Math.abs(W(e,c)+(e.k>0?-r:r)+(i>0?-e.r:e.r))}return o(a[0])<o(a[1])?a[0]:a[1]}function k(e=1,t=100,s=600,n=1/0,i=1/0){return{s:e,x:t,y:s,w:n,h:i}}function v(e,t){return Math.floor(e.x+t*e.s)}function M(e,t){return Math.floor(e.y+t*e.s)}function C(e,t,s,n){const i=1/Math.abs(e);return{kind:"circle",k:e,x:t,y:s,_depth:n,r:i,diameter:2*i}}function z(e){return e.k<0}function et(e,t,s=k()){const n=v(s,t.x),i=M(s,t.y),r=t.r*s.s;e.beginPath(),e.arc(n,i,r,0,2*Math.PI),e.stroke()}function O(e){return e._depth}function st(e,t,s=k()){t.m===1/0?(e.beginPath(),e.moveTo(v(s,t.b),M(s,0)),e.lineTo(v(s,t.b),M(s,l.getH())),e.stroke()):(e.beginPath(),e.moveTo(v(s,0),M(s,t.b)),e.lineTo(v(s,l.getW()),M(s,l.getW()*t.m+t.b)),e.stroke())}function x(e){return e.k}function it(e){return e._depth}function S(e,t,s=k()){t.kind==="circle"?et(e,t,s):st(e,t,s)}class nt{canvas;ctx;scale;constructor(t){const s=document.getElementById(t);if(!s)throw new Error(`Canvas with id "${t}" not found`);this.canvas=s;const n=this.canvas.getContext("2d");if(!n)throw new Error("Could not get 2D context");this.ctx=n,this.canvas.width=1200,this.canvas.height=1200,this.canvas.style.border="2px solid black",l.setDimensions(this.canvas.width,this.canvas.height),this.scale=k(),this.canvas.tabIndex=1,this.canvas.focus(),document.addEventListener("keypress",i=>this.handleKey(i)),this.paint()}zoomAroundCenter(t,s){const n=this.canvas.width/2,i=this.canvas.height/2,r=(n-t.x)/t.s,a=(i-t.y)/t.s,o=t.s*s,c=Math.floor(n-r*o),h=Math.floor(i-a*o);return k(o,c,h,t.w,t.h)}handleKey(t){const s=t.key;switch(s){case" ":l.triple.recurse();break;case"=":case"+":this.scale=this.zoomAroundCenter(this.scale,1.2);break;case"-":case"_":this.scale=this.zoomAroundCenter(this.scale,1/1.2);break;case"ArrowLeft":case"h":this.scale=k(this.scale.s,this.scale.x+10,this.scale.y,this.scale.w,this.scale.h);break;case"ArrowRight":case"l":this.scale=k(this.scale.s,this.scale.x-10,this.scale.y,this.scale.w,this.scale.h);break;case"ArrowDown":case"j":this.scale=k(this.scale.s,this.scale.x,this.scale.y-10,this.scale.w,this.scale.h);break;case"ArrowUp":case"k":this.scale=k(this.scale.s,this.scale.x,this.scale.y+10,this.scale.w,this.scale.h);break;case"H":this.scale=k(this.scale.s,this.scale.x+40,this.scale.y,this.scale.w,this.scale.h);break;case"L":this.scale=k(this.scale.s,this.scale.x-40,this.scale.y,this.scale.w,this.scale.h);break;case"J":this.scale=k(this.scale.s,this.scale.x,this.scale.y-40,this.scale.w,this.scale.h);break;case"K":this.scale=k(this.scale.s,this.scale.x,this.scale.y+40,this.scale.w,this.scale.h);break;case"w":l.adjustR2(.01),l.rebuildTriple();break;case"s":l.adjustR2(-.01),l.rebuildTriple();break;case"a":l.adjustR1(-.01),l.rebuildTriple();break;case"d":l.adjustR1(.01),l.rebuildTriple();break;default:console.log("Wrong key! "+s);return}this.paint()}paint(){const t=this.ctx,s=this.canvas.width,n=this.canvas.height;t.fillStyle="white",t.fillRect(0,0,s,n),t.strokeStyle="red",t.lineWidth=3,l.triple.draw(t,this.scale,null,!0),this.drawCursor(t);const i=document.getElementById("dot");i.style.left=`calc(${100*l.r1}% - 4px)`,i.style.bottom=`calc(${100*l.r2}% - 4px)`;const r=document.getElementById("current-ratio-pair"),a=o=>Math.round(o*1e5)/1e5;r.innerText=`${a(l.r1)}, ${a(l.r2)}`}drawCursor(t){const s=this.canvas.width/2,n=this.canvas.height/2;t.save(),t.strokeStyle="rgb(30, 30, 30)",t.lineWidth=1.5;const i=8;t.beginPath(),t.moveTo(s-i,n),t.lineTo(s+i,n),t.stroke(),t.beginPath(),t.moveTo(s,n-i),t.lineTo(s,n+i),t.stroke(),t.restore()}drawRBox(t){const i=this.canvas.width-120-16,r=16;t.save(),t.fillStyle="rgb(245, 245, 245)",t.fillRect(i,r,120,120),t.strokeStyle="darkgray",t.lineWidth=1,t.strokeRect(i,r,120,120),t.fillStyle="black",t.font="12px sans-serif",t.fillText("r1 →",i+120-40,r+120+12),t.fillText("↑",i-10,r+12),t.fillText("r2",i-10,r+24);const a=f=>Math.max(0,Math.min(1,f)),o=f=>{const w=(a(f)-0)/1;return Math.floor(w*120)};t.strokeStyle="rgb(200, 200, 200)",[0,.25,.5,.75,1].forEach(f=>{const w=o(f);t.beginPath(),t.moveTo(i+w,r),t.lineTo(i+w,r+120),t.stroke(),t.beginPath(),t.moveTo(i,r+(120-w)),t.lineTo(i+120,r+(120-w)),t.stroke()});const h=i+o(l.r1),u=r+(120-o(l.r2)),d=5;t.fillStyle="red",t.beginPath(),t.arc(h,u,d,0,2*Math.PI),t.fill(),t.strokeStyle="black",t.beginPath(),t.arc(h,u,d,0,2*Math.PI),t.stroke(),t.restore()}}document.addEventListener("DOMContentLoaded",()=>{l.rebuildTriple(),new nt("canvas1");const e=j("canvas2",1,.5,.5),t=document.getElementById("loading");t.showModal(),setTimeout(()=>{G(e),t.close()},1)});
