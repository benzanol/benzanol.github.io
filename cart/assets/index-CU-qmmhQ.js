(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=o(r);fetch(r.href,a)}})();function addEquation(n,e,o){const i=document.createElement("div"),r=document.createElement("button");r.textContent="Ã—",r.classList.add("delete-button"),r.onclick=()=>deleteEquation(i),i.append(r,document.createTextNode("Time: "),createInput(1,n,e),document.createTextNode("Equation: "),createInput(30,n,o)),document.getElementById("equations").appendChild(i)}function deleteEquation(n){document.getElementById("equations").removeChild(n)}function createInput(n,e,o){const i=document.createElement("input");return i.type="text",i.size=n,i.addEventListener("input",e),console.log("Event=",e),o&&(i.value=o),i}addEquation(updateEquations,"6","5*Math.sin(t*10)");addEquation(updateEquations,"2","(t-6)**5");document.getElementById("add-equation").onclick=()=>addEquation(updateEquations);document.getElementById("starting-angle").addEventListener("input",updateEquations);const radToDeg=180/Math.PI,steps=1e4,gravity=1;var totalTime,equations,forces=Array(steps+1),positions=Array(steps+1),velocities=Array(steps+1),angles=Array(steps+1),angVels=Array(steps+1),currentIndex=0,startAngle=0;function calculate(){equations=[],totalTime=0,currentIndex=0;for(let s of document.getElementById("equations").children){let d=s.children[1].value,l=+d;if(!isFinite(l)||l<0)throw new Error(`Invalid length of time: ${d}`);totalTime+=l,equations.push({time:l,equation:s.children[2].value})}let n=+document.getElementById("starting-angle").value;if(isFinite(n)&&n>=0&&n<=180)startAngle=n/radToDeg;else throw new Error("Invalid starting angle");let e=totalTime/steps,o=0,i=0,r=startAngle,a=0;for(let s=0;s<=steps;s++){const d=forceAtTime(equations,s*e);forces[s]=d,angles[s]=r,angVels[s]=a,positions[s]=o,velocities[s]=i;let l=a;a+=e*(d*Math.sin(r)-gravity*Math.cos(r)),r+=e*l,o+=e*i,i+=e*d}}function forceAtTime(equations,t){let endTime=0;for(let{time,equation}of equations)if(endTime+=time,t<=endTime){let result=eval(equation);if(typeof result=="number"&&isFinite(result))return result;throw new Error(`Invalid equation result: ${result} from ${equation}`)}throw new Error("Reached end of forceAtTime")}function drawGraph(){document.getElementById("t-label").innerText=truncString(currentIndex/steps*totalTime),document.getElementById("theta-label").innerText=truncString(angles[currentIndex]*radToDeg),document.getElementById("angvel-label").innerText=truncString(angVels[currentIndex]*radToDeg),document.getElementById("f-label").innerText=truncString(forces[currentIndex]),document.getElementById("v-label").innerText=truncString(velocities[currentIndex]),document.getElementById("x-label").innerText=truncString(positions[currentIndex]);const n=document.getElementById("graph-canvas"),e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillRect(0,0,n.width,n.height),e.clearRect(1,1,n.width-2,n.height-2),drawOneGraph(e,forces,"#7EC0EE"),drawOneGraph(e,velocities,"#119944"),drawOneGraph(e,angles,"#551A8B",0,Math.PI);const o=1,i=(n.width-o)/steps,r=currentIndex*i+o;e.strokeStyle="#DD2222",e.lineWidth=1,e.beginPath(),e.moveTo(r,1),e.lineTo(r,n.height-1),e.closePath(),e.stroke()}function drawOneGraph(n,e,o,i,r){let a=20,s=n.canvas.height-2*a;const d=r??e.reduce((c,m)=>Math.max(c,m)),l=i??e.reduce((c,m)=>Math.min(c,m)),g=1,h=(n.canvas.width-g)/steps,f=Math.max(d-l,2e-5),p=s/f;n.strokeStyle=o,n.lineWidth=2,n.beginPath();const u=steps/500;for(let c=0;c<e.length-2;c+=2*u){const[m,I,v]=[0,1,2].map(y=>(c+y*u)*h+g),[E,x,T]=[0,1,2].map(y=>s+a-(e[c+y*u]-l+1e-5)*p);n.moveTo(m,E),n.quadraticCurveTo(I,x,v,T)}n.closePath(),n.stroke()}function truncString(n){const e=`${n}`;return e.length<6?e:e.substring(0,6)}function drawCart(){const n=document.getElementById("cart-canvas"),e=n.getContext("2d"),o=n.height;e.clearRect(0,0,n.width,n.height),e.fillRect(0,0,n.width,n.height),e.clearRect(1,1,n.width-2,n.height-2);const i=80,r=100,a=20,s=90,d=Math.max(...positions),l=Math.min(...positions),g=(n.width-i)/Math.max(d-l,1e-4),h=(positions[currentIndex]-l)*g,f=h+i/2,p=angles[currentIndex];e.fillRect(h,o-r,i,a);let u=f+s*Math.cos(p),c=o-(r+s*Math.sin(p));e.lineWidth=3,e.beginPath(),e.moveTo(f,o-r),e.lineTo(u,c),e.closePath(),e.stroke(),e.beginPath(),e.arc(u,c,15,0,2*Math.PI),e.closePath(),e.fill()}function updateEquations(){slider.value=0,calculate(),drawGraph(),drawCart()}function slide(){currentIndex=slider.value*steps/1e3,equations&&(drawGraph(),drawCart())}const slider=document.getElementById("time-slider");slider.addEventListener("input",slide);slider.value=0;document.getElementById("play-button").onclick=play;function play(n){typeof n=="number"?currentIndex=n:currentIndex=0,drawGraph(),drawCart();const e=currentIndex+steps/100;e<=steps&&setTimeout(play,50,e)}document.getElementById("solve").onclick=solve;function solve(){let n=Math.PI,e=0,o;for(let i=1;i<100;i++){o=e+(n-e)/2;let r=checkAngle(o);if(r==-1)e=o;else if(r==1)n=o;else{let a=o*radToDeg;document.getElementById("angle-solution").innerText=a.toString(),document.getElementById("angle-iterations").innerText=`Found after ${i} attempts`;return}}document.getElementById("angle-solution").innerText="Function exceeds maximum precision.",document.getElementById("angle-iterations").innerText=`Closest = ${o*radToDeg}`}function checkAngle(n){let e=totalTime/steps,o=n,i=0;for(let r=0;r<=steps;r++){const a=forceAtTime(equations,r*e);let s=i;if(i+=e*(a*Math.sin(o)-gravity*Math.cos(o)),o+=e*s,o<=0)return-1;if(o>=Math.PI)return 1}return 0}document.getElementById("starting-angle").value="0";updateEquations();
