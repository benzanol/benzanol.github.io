(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();function addEquation(n){const e=document.createElement("div"),r=document.createElement("button");r.textContent="Ã—",r.classList.add("delete-button"),r.onclick=()=>deleteEquation(e),e.append(r,document.createTextNode("Time: "),createInput(1,n),document.createTextNode("Equation: "),createInput(30,n)),document.getElementById("equations").appendChild(e)}function deleteEquation(n){document.getElementById("equations").removeChild(n)}function createInput(n,e){const r=document.createElement("input");return r.type="text",r.size=n,r.addEventListener("input",e),console.log("Event=",e),r}addEquation(updateEquations);document.getElementById("add-equation").onclick=()=>addEquation(updateEquations);document.getElementById("starting-angle").addEventListener("input",updateEquations);const radToDeg=180/Math.PI,steps=1e4,gravity=1;var totalTime,equations,forces=Array(steps+1),positions=Array(steps+1),velocities=Array(steps+1),angles=Array(steps+1),angVels=Array(steps+1),currentIndex=0,startAngle;function calculate(){equations=[],totalTime=0,currentIndex=0;for(let a of document.getElementById("equations").children){let d=a.children[1].value,l=+d;if(!isFinite(l)||l<0)throw new Error(`Invalid length of time: ${d}`);totalTime+=l,equations.push({time:l,equation:a.children[2].value})}let n=+document.getElementById("starting-angle").value;if(isFinite(n)&&n>=0&&n<=180)startAngle=n/radToDeg;else throw new Error("Invalid starting angle");let e=totalTime/steps,r=0,s=0,o=startAngle,i=0;for(let a=0;a<=steps;a++){const d=forceAtTime(equations,a*e);forces[a]=d,angles[a]=o,angVels[a]=i,positions[a]=r,velocities[a]=s;let l=i;i+=e*(d*Math.sin(o)-gravity*Math.cos(o)),o+=e*l,r+=e*s,s+=e*d}}function forceAtTime(equations,t){let endTime=0;for(let{time,equation}of equations)if(endTime+=time,t<=endTime){let result=eval(equation);if(typeof result=="number"&&isFinite(result))return result;throw new Error(`Invalid equation result: ${result} from ${equation}`)}throw new Error("Reached end of forceAtTime")}function drawGraph(){document.getElementById("t-label").innerText=truncString(currentIndex/steps*totalTime),document.getElementById("theta-label").innerText=truncString(angles[currentIndex]*radToDeg),document.getElementById("angvel-label").innerText=truncString(angVels[currentIndex]*radToDeg),document.getElementById("f-label").innerText=truncString(forces[currentIndex]),document.getElementById("v-label").innerText=truncString(velocities[currentIndex]),document.getElementById("x-label").innerText=truncString(positions[currentIndex]);const n=document.getElementById("graph-canvas"),e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillRect(0,0,n.width,n.height),e.clearRect(1,1,n.width-2,n.height-2),drawOneGraph(e,forces,"#7EC0EE"),drawOneGraph(e,velocities,"#119944"),drawOneGraph(e,angles,"#551A8B",0,Math.PI);const r=1,s=(n.width-r)/steps,o=currentIndex*s+r;e.strokeStyle="#DD2222",e.lineWidth=1,e.beginPath(),e.moveTo(o,1),e.lineTo(o,n.height-1),e.closePath(),e.stroke()}function drawOneGraph(n,e,r,s,o){let i=20,a=n.canvas.height-2*i;const d=o??e.reduce((c,m)=>Math.max(c,m)),l=s??e.reduce((c,m)=>Math.min(c,m)),g=1,h=(n.canvas.width-g)/steps,f=Math.max(d-l,2e-5),p=a/f;n.strokeStyle=r,n.lineWidth=2,n.beginPath();const u=steps/500;for(let c=0;c<e.length-2;c+=2*u){const[m,I,v]=[0,1,2].map(y=>(c+y*u)*h+g),[x,E,T]=[0,1,2].map(y=>a+i-(e[c+y*u]-l+1e-5)*p);n.moveTo(m,x),n.quadraticCurveTo(I,E,v,T)}n.closePath(),n.stroke()}function truncString(n){const e=`${n}`;return e.length<6?e:e.substring(0,6)}function drawCart(){const n=document.getElementById("cart-canvas"),e=n.getContext("2d"),r=n.height;e.clearRect(0,0,n.width,n.height),e.fillRect(0,0,n.width,n.height),e.clearRect(1,1,n.width-2,n.height-2);const s=80,o=100,i=20,a=90,d=Math.max(...positions),l=Math.min(...positions),g=(n.width-s)/Math.max(d-l,1e-4),h=(positions[currentIndex]-l)*g,f=h+s/2,p=angles[currentIndex];e.fillRect(h,r-o,s,i);let u=f+a*Math.cos(p),c=r-(o+a*Math.sin(p));e.lineWidth=3,e.beginPath(),e.moveTo(f,r-o),e.lineTo(u,c),e.closePath(),e.stroke(),e.beginPath(),e.arc(u,c,15,0,2*Math.PI),e.closePath(),e.fill()}function updateEquations(){slider.value=0,calculate(),drawGraph(),drawCart()}function slide(){currentIndex=slider.value*steps/1e3,equations&&(drawGraph(),drawCart())}const slider=document.getElementById("time-slider");slider.addEventListener("input",slide);slider.value=0;document.getElementById("play-button").onclick=play;function play(n){typeof n=="number"?currentIndex=n:currentIndex=0,drawGraph(),drawCart();const e=currentIndex+steps/100;e<=steps&&setTimeout(play,50,e)}document.getElementById("solve").onclick=solve;function solve(){let n=Math.PI,e=0,r;for(let s=1;s<100;s++){r=e+(n-e)/2;let o=checkAngle(r);if(o==-1)e=r;else if(o==1)n=r;else{let i=r*radToDeg;document.getElementById("angle-solution").innerText=i.toString(),document.getElementById("angle-iterations").innerText=`Found after ${s} attempts`;return}}document.getElementById("angle-solution").innerText="Function exceeds maximum precision.",document.getElementById("angle-iterations").innerText=`Closest = ${r*radToDeg}`}function checkAngle(n){let e=totalTime/steps,r=n,s=0;for(let o=0;o<=steps;o++){const i=forceAtTime(equations,o*e);let a=s;if(s+=e*(i*Math.sin(r)-gravity*Math.cos(r)),r+=e*a,r<=0)return-1;if(r>=Math.PI)return 1}return 0}
